## at 命令

> windows 2000

描述：

​	at 命令是计划在指定日期和时间, 在计算机上运行命令和程序, 要使用 at 命令必须开启 schedule 服务才可使用, 用 net start schedule 来开启服务

~~~
at /? # 查看具体操作
~~~



at [\\computername] [ [id] [/DELETE] | /DELETE [/YES] [\\computername] time [/INTERACTIVE[ /EVERY:date[,...] | /NEXT:date[,...]] "command"

参数:

​    \\computername 指定远程计算机, 如果省略这个参数, 会计划在本地计算机上运行命令

​     id 指定已计划命令的识别号

​     /delete 删除某个已计划的命令, 如果省略 id, 计算机上所有已计划的命令都会被删除,

​     /yes 不需要进一步确认时, 跟删除所有作业的命令一起使用

​     /time 指定运行命令的时间

​     /interactive 允许作业在运行时, 与当时登录的用户桌面进行交互

​     /every:date[. . .] 指定在每周或每月的特定日期运行命令. 如果省略日期,则默认为在每月的本日运行

​     /next:date[. . .] 指定在下一个指定日期( 如, 下周三) 运行命令, 如果省略日期, 则默认为在每月的本日运行

​     "command" 准备运行的 windows NT 命令或批处理程序

at 后面的 [ ] 为可选项

设置定时任务

~~~
at [\\computername] time [/interactive] [/every:date[,...]| /next:date[,...]] command 
at [\\computername] 00:00 [/interactive] c:\demo.bat
~~~

查看定时任务

~~~
at [\\computername]
~~~

删除定时任务

~~~
at [\\computername] [id] /delete yes
~~~



## schtasks 命令

> at 命令在windows 后续更新中被遗弃、
>

描述：

允许管理员创建、删除、查询、更改、运行和中止本地或远程系统上的计划任务。

查看操作

~~~markdown
schtasks /?
~~~

参数列表：

  /Create     创建新计划任务。
  /Delete     删除计划任务。
  /Query     显示所有计划任务。
  /Change     更改计划任务属性。
  /Run      按需运行计划任务。
  /End      中止当前正在运行的计划任务。
  /ShowSid    显示与计划的任务名称相应的安全标识符。
  /?       显示帮助消息。

创建新计划任务
SCHTASKS /Create [/S system [/U username [/P [password]]]]
  [/RU username [/RP password]] /SC schedule [/MO modifier] [/D day]
  [/M months] [/I idletime] /TN taskname /TR taskrun [/ST starttime]
  [/RI interval] [ {/ET endtime | /DU duration} [/K] [/XML xmlfile] [/V1]]
  [/SD startdate] [/ED enddate] [/IT | /NP] [/Z] [/F]

设置定时任务

~~~markdown
schtasks /Create /S 192.168.1.5 /U Administrator /P 123456 /TN taskName /TR c:\run.exe /SC once /ST 00:00
/Create 			 创建

/S 	 system       指定要连接到的远程系统。如果省略这个系统参数，默认是本地系统。

/U   username      指定应在其中执行 SchTasks.exe 的用户上下文。

/P   [password]    指定给定用户上下文的密码。如果省略则提示输入。

/TN   taskname     指定唯一识别这个计划任务的名称。

/TR   taskrun      指定在这个计划时间运行的程序的路径

/SC	  scheduletype	指定计划类型

/ST   				时间

~~~

























































